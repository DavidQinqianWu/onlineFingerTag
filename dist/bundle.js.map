{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./src/util/scale.ts","webpack:///./src/index.ts","webpack:///./src/util/request.ts","webpack:///./src/render/render.ts","webpack:///./src/render/xml2svg.ts","webpack:///./src/ui/container.ts","webpack:///./src/parse/parse.ts"],"names":["root","factory","exports","module","define","amd","a","i","window","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","abcSystemScale","param_","document","getElementsByClassName","clientWidth","setScale","scale_","this","_pageScale","_innerScale","scale","number","url","Promise","resolve","reject","getQueryVariable","$","data","status","xmlId2StaffMap","getNoteXmlObj","generateRenderInstance","renderScore","contentDiv","innerHTML","noteBtnDivStr","buildEachClickButton","submitResult","onload","Index","then","reason","console","error","clickBtn","e","className","classList","replace","resetBtn","clickBtns","length","submitBtn","id","getAttribute","log","variable","vars","location","search","substring","split","pair","convertStringToXmlDom","xmlString_","DOMParser","parseFromString","dom_","_dom","_instance","Render","abcModal","CreateABCStr","noTitle","noPiano","svgModalOptions","getSVGModalOptions","abcStr","svgModal","CreateSvgStr","getElementById","svgStr","abcStr_","result","xmlDom","options","abcOpn","svgObj","vertaal","_list","abcTList","noTitleFn","noPianoFn","abc","abcArr","encodeURI","list","char","decodeURI","push","filter","item","curCodeList","join","map","indexOf","forEach","el","splice","svgLineList","measuresObj","imagesize","pagescale","user","img_out","svgOut","errbld","msg","y","read_file","x","measure_draw","measureDraw","anno_start","annoStart","anno_stop","annoStop","page_format","no_margin_yym","page_width_yym","abc2svg","Abc","tosvg","abcSystemHeightArray","systemHeightArray","str","measure","cls_name","contentDivWidth","contentDivHeight","clientHeight","notes","Array","note","noteXmlId","systemTop","parentElement","offsetTop","noteX","parseFloat","yPercentage","heightPercentage","temp","toFixed","xmlIdStaffMap","getElementsByTagName","staff","xmlId"],"mappings":"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","file":"bundle.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","export default class Scale {\n  public static _pageScale: number;\n  private static _innerScale: number;\n  public static abcSystemScale(param_: number) {\n    return (\n      (document.getElementsByClassName(\"nobrk\")[0].clientWidth / 794) * param_\n    );\n  }\n\n  public static setScale(scale_: number) {\n    this._pageScale = scale_;\n    this._innerScale =\n      document.getElementsByClassName(\"nobrk\")[0].clientWidth / 794;\n  }\n\n  public static scale(number: number): number {\n    return this._pageScale * number * this._innerScale;\n  }\n}\n","/// <reference path=\"../declare/declare.d.ts\" />;\nimport YYM_Request from \"./util/request\";\nimport Render from \"./render/render\";\nimport Scale from \"./util/scale\";\nimport Container from \"./ui/container\";\nimport Prase from \"./parse/parse\";\n\nclass Index {\n  constructor() {}\n  public url(): Promise<object | string> {\n    return new Promise((resolve, reject) => {\n      let url: string | undefined = YYM_Request.getQueryVariable(\"url\");\n      if (url) {\n        $.get(url, async function (data: Document, status: string) {\n          if (status === \"success\") {\n            let xmlId2StaffMap = new Prase(data).getNoteXmlObj();\n            let renderInstance = Render.generateRenderInstance(data);\n            renderInstance.renderScore();\n            Scale.setScale(1.5);\n            // 渲染成功之后\n            const contentDiv = document.getElementsByClassName(\"nobrk\")[0];\n            if (contentDiv?.innerHTML) {\n              // 给音符画div\n              let noteBtnDivStr = Container.buildEachClickButton(contentDiv);\n              contentDiv.innerHTML += noteBtnDivStr;\n              resolve(xmlId2StaffMap);\n            } else {\n              reject(\"曲谱加载失败\");\n            }\n          }\n        });\n      } else {\n        reject(\"没有获得url地址\");\n      }\n    });\n  }\n}\n\n(window as any).xmlId2StaffMap = {};\n(window as any).submitResult = {};\n\nwindow.onload = () => {\n  new Index().url().then(\n    (value) => {\n      (window as any).xmlId2StaffMap = value;\n    },\n    (reason) => {\n      console.error(reason);\n    }\n  );\n};\n\n(window as any).clickBtn = (e: HTMLElement) => {\n  if (e.className === \"noteClickBtn_none\") {\n    e.classList.replace(\"noteClickBtn_none\", \"noteClickBtn_click\");\n  } else {\n    e.classList.replace(\"noteClickBtn_click\", \"noteClickBtn_none\");\n  }\n};\n\n(window as any).resetBtn = () => {\n  let clickBtns = document.getElementsByClassName(\"noteClickBtn_click\");\n  while (clickBtns.length) {\n    clickBtns[0].classList.replace(\"noteClickBtn_click\", \"noteClickBtn_none\");\n  }\n};\n\n(window as any).submitBtn = () => {\n  let clickBtns = document.getElementsByClassName(\"noteClickBtn_click\");\n  for (let i = 0; i < clickBtns.length; i++) {\n    let clickBtn = clickBtns[i];\n    let id = clickBtn.getAttribute(\"id\");\n    if (id) {\n      (window as any).xmlId2StaffMap[id] === \"1\"\n        ? ((window as any).submitResult[id] = \"2\")\n        : ((window as any).submitResult[id] = \"1\");\n    }\n  }\n  console.log((window as any).submitResult);\n  // 上传后台\n};\n","export default class YYM_Request {\n  public static getQueryVariable(variable: string): string | undefined {\n    let query = window.location.search.substring(1);\n    let vars = query.split(\"&\");\n    for (let i = 0; i < vars.length; i++) {\n      let pair = vars[i].split(\"=\");\n      if (pair[0] == variable) {\n        return pair[1];\n      }\n    }\n    return undefined;\n  }\n\n  public static convertStringToXmlDom(xmlString_: string) {\n    return new DOMParser().parseFromString(xmlString_, \"text/xml\");\n  }\n}\n","import YYM_Request from \"../util/request\";\nimport { CreateABCStr, CreateSvgStr } from \"./xml2svg\";\nexport default class Render {\n  private static _instance: Render;\n  private _dom: Document;\n\n  constructor(dom_: Document) {\n    this._dom = dom_;\n  }\n\n  // 单例模式\n  public static generateRenderInstance(dom_: Document) {\n    if (!this._instance) {\n      this._instance = new Render(dom_);\n    }\n    return this._instance;\n  }\n  public renderScore() {\n    const abcModalOption = { noTitle: true, noPiano: true };\n    // 此时拿到   xml=>abc\n    const abcModal = new CreateABCStr(this._dom, abcModalOption);\n    const svgModalOptions = this.getSVGModalOptions(abcModal.abcStr);\n    const svgModal = new CreateSvgStr(svgModalOptions);\n    document.getElementById(\"content\")!.innerHTML = svgModal.svgStr;\n  }\n\n  private getSVGModalOptions(abcStr_: string) {\n    let result: svgModalOptionsParam = {} as svgModalOptionsParam;\n    result.pagescale = 1.5;\n    result.abcStr = abcStr_;\n    return result;\n  }\n}\n\ninterface svgModalOptionsParam {\n  abcStr: string;\n  pagescale: number;\n}\n","/* eslint-disable @typescript-eslint/no-this-alias */\n/* eslint-disable no-undef */\n// eslint-disable-next-line spaced-comment\n/**\n * 根据xml字符串转码为abc字符串\n * @param {String} xmlStr xml字符串\n * @param {Object} abcOpn 生成abc字符串参数\n */\nexport class CreateABCStr {\n  private xmlDom: Document;\n  public abcStr: string;\n  private _list: string[];\n  public constructor(xmlDom: Document, options: any) {\n    options.abcOpn = options.abcOpn || { p: \"\" };\n    options.noTitle = options.noTitle || false;\n    options.noPiano = options.noPiano || false;\n    this.xmlDom = xmlDom;\n    const svgObj = vertaal(this.xmlDom, options.abcOpn);\n    this.abcStr = svgObj[0];\n    this._list = this.abcTList(this.abcStr);\n    if (options.noTitle) {\n      this.abcStr = this.noTitleFn();\n    }\n    if (options.noPiano) {\n      this.abcStr = this.noPianoFn();\n    }\n  }\n\n  private abcTList(abc: string) {\n    const neu = encodeURI(abc);\n    const abcArr: string[] = neu.split(\"%0A\");\n    const list: string[] = [];\n    for (let i = 0; i < abcArr.length; i++) {\n      let char: string = decodeURI(abcArr[i]);\n      list.push(char);\n    }\n    return list;\n  }\n\n  private noTitleFn() {\n    this._list = this._list.filter((item) => {\n      const curCodeList = item.split(\"\");\n      return !(\n        (curCodeList[0] === \"T\" ||\n          curCodeList[0] === \"C\" ||\n          curCodeList[0] === \"Q\" ||\n          curCodeList[0] === \"Z\") &&\n        curCodeList[1] === \":\"\n      );\n    });\n    return this._list.join(\"\\n\");\n  }\n\n  private noPianoFn() {\n    this._list = this._list.map((item) => {\n      const curCodeList = item.split(\"\");\n      if (curCodeList[0] === \"V\" && curCodeList[1] === \":\") {\n        if (curCodeList.indexOf(\"=\") >= 0) {\n          const indices: number[] = [];\n          curCodeList.forEach((el, i) => el === \" \" && indices.push(i));\n          curCodeList.splice(indices[1], curCodeList.length);\n          return curCodeList.join(\"\");\n        }\n      }\n      return item;\n    });\n    return this._list.join(\"\\n\");\n  }\n}\n\n/**\n * 根据abc生成svg字符串\n * @param {String} abcStr abc字符串\n * @param {String} imagesize 设置svg大小\n */\nexport class CreateSvgStr {\n  public svgStr: string;\n  private svgLineList: string[];\n  private measuresObj: {};\n  private abcStr: string;\n  private abc2svg: any;\n  public abcSystemHeightArray: string[];\n\n  public constructor(options) {\n    if (options.abcStr) {\n      this.svgStr = \"\";\n      this.svgLineList = [];\n      this.measuresObj = {};\n      options.imagesize = options.imagesize || 'width=\"100%\"';\n      options.pagescale = options.pagescale || 1;\n      const that = this;\n      let errorFunction = function (msg, l, c, y) {\n        console.error(msg, l, c, y);\n      };\n\n      const user = {\n        imagesize: options.imagesize,\n        img_out: this.svgOut.bind(that),\n        // To SVG 渲染曲谱报错信息查询\n        errbld: errorFunction,\n        read_file: function (x) {\n          return \"\";\n        },\n        measure_draw: this.measureDraw.bind(that),\n        anno_start: options.annoStart,\n        anno_stop: options.annoStop,\n        page_format: true,\n        no_margin_yym: true,\n        page_width_yym: false,\n      };\n\n      this.abcStr = `%%topspace 0cm\\n%%pagescale ${options.pagescale}\\n%%measurenb 0\\n${options.abcStr}`;\n\n      this.abc2svg = new Abc(user);\n      this.abc2svg.tosvg(\"\", this.abcStr);\n      this.abcSystemHeightArray = this.abc2svg.systemHeightArray;\n    }\n  }\n\n  private svgOut(str: string) {\n    this.svgLineList.push(str);\n    this.svgStr += str;\n  }\n\n  private measureDraw(measure) {\n    this.measuresObj[measure.cls_name] = measure;\n  }\n}\n","import Scale from \"../util/scale\";\n\nexport default class Container {\n  public static buildEachClickButton(contentDiv: Element): string {\n    const contentDivWidth = contentDiv.clientWidth!;\n    const contentDivHeight = contentDiv.clientHeight!;\n\n    let notes = document.getElementsByClassName(\"note\");\n    let noteBtnDivStr = \"\";\n\n    Array.prototype.forEach.call(notes, (note: HTMLElement) => {\n      const firstClassName = note.classList[0];\n      // 得到class = “note_id_1” 这样的xml id值\n      const noteXmlId: string = firstClassName.substring(8);\n      let systemTop =\n        note.parentElement?.parentElement?.parentElement?.offsetTop;\n      let noteX = Scale.scale(parseFloat(note.getAttribute(\"x\")!) - 1);\n      let noteY =\n        Scale.scale(parseFloat(note.getAttribute(\"y\")!) - 4) + systemTop!;\n      let xPercentage = (noteX / contentDivWidth) * 100;\n      let yPercentage = (noteY / contentDivHeight) * 100;\n      let widthPercentage = 13 / 1200;\n      let widthPx = contentDivWidth * widthPercentage;\n      let heightPercentage = (widthPx / contentDivHeight) * 100;\n      let temp = `<div class=\"noteClickBtn_none\" id=\"${noteXmlId}\" style=\"left:${xPercentage.toFixed(\n        2\n      )}%; top:${yPercentage.toFixed(2)}%; width:${((17 / 1200) * 100).toFixed(\n        2\n      )}%; height: ${heightPercentage.toFixed(\n        2\n      )}%; position:absolute; z-index:3\" onclick=\"clickBtn(this)\"></div>`;\n      noteBtnDivStr += temp;\n    });\n    return noteBtnDivStr;\n  }\n}\n","import { iNote } from \"../interface/interface\";\nexport default class Prase {\n  private _dom: Document;\n  constructor(dom_: Document) {\n    this._dom = dom_;\n  }\n  public getNoteXmlObj() {\n    let xmlIdStaffMap = {};\n    let notes = this._dom.getElementsByTagName(\"note\");\n    for (let i = 0; i < notes.length; i++) {\n      let note = notes[i];\n      let staff = note.getElementsByTagName(\"staff\")[0].innerHTML;\n      let temp: iNote = {} as iNote;\n      temp.xmlId = i;\n      staff\n        ? ((temp.staff = staff), (xmlIdStaffMap[temp.xmlId] = staff))\n        : ((temp.staff = \"0\"),\n          console.error(\n            `第${note.parentElement?.getAttribute(\n              \"number\"\n            )}小节出现音符没有staff`\n          ));\n    }\n    return xmlIdStaffMap;\n  }\n}\n"],"sourceRoot":""}